<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VibeAll Web Preview</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            background-color: #1e1e1e;
            /* VS Code Dark Default */
            color: #cccccc;
        }

        /* Mock VS Code variables */
        :root {
            --vscode-editor-background: #1e1e1e;
            --vscode-editor-foreground: #cccccc;
            --vscode-sideBar-background: #252526;
            --vscode-panel-border: rgba(128, 128, 128, 0.35);
            --vscode-button-background: #0e639c;
            --vscode-button-foreground: #ffffff;
            --vscode-button-hoverBackground: #1177bb;
            --vscode-button-secondaryBackground: #3a3d41;
            --vscode-button-secondaryForeground: #ffffff;
            --vscode-button-secondaryHoverBackground: #45494e;
            --vscode-input-background: #3c3c3c;
            --vscode-input-border: #3c3c3c;
            --vscode-input-foreground: #cccccc;
            --vscode-input-placeholderForeground: #a6a6a6;
            --vscode-list-hoverBackground: #2a2d2e;
            --vscode-descriptionForeground: #8b949e;
            --vscode-textCodeBlock-background: #0a0a0a;
            --vscode-widget-border: #454545;
            --vscode-scrollbarSlider-background: rgba(121, 121, 121, 0.4);
            --vscode-scrollbarSlider-hoverBackground: rgba(100, 100, 100, 0.7);
            --vscode-dropdown-background: #3c3c3c;
            --vscode-dropdown-foreground: #f0f0f0;
            --vscode-textBlockQuote-background: rgba(127, 127, 127, 0.1);
        }
    </style>
    <script>
        // Mock VS Code API
        window.acquireVsCodeApi = () => {
            return {
                postMessage: (message) => {
                    console.log('üì§ [VS Code Mock] Post Message:', message);

                    // Simulate responses for valid message types
                    setTimeout(() => {
                        handleMockResponse(message);
                    }, 500);
                },
                setState: (state) => {
                    console.log('üíæ [VS Code Mock] Set State:', state);
                    localStorage.setItem('vscodeState', JSON.stringify(state));
                },
                getState: () => {
                    const state = JSON.parse(localStorage.getItem('vscodeState') || '{}');
                    console.log('üìñ [VS Code Mock] Get State:', state);
                    return state;
                }
            };
        };

        function handleMockResponse(message) {
            const event = new Event('message');
            // Default mock data
            let payload = null;

            switch (message.type) {
                case 'getSettings':
                    payload = {
                        autoRunCommands: false,
                        autoApplyEdits: false,
                        showMiniDashboard: true,
                        compactMode: false,
                        theme: { primaryColor: '#6366f1', accentColor: '#8b5cf6', mode: 'dark' }
                    };
                    window.postMessage({ type: 'settings', payload }, '*');
                    break;

                case 'getChatHistory':
                    window.postMessage({ type: 'chatHistory', payload: [] }, '*');
                    break;

                case 'getUsageStats':
                    window.postMessage({
                        type: 'usageStats',
                        payload: { groq: { requests: 10, tokens: 500, lastUsed: Date.now() } }
                    }, '*');
                    break;

                case 'getAPIKeys':
                    window.postMessage({
                        type: 'apiKeys',
                        payload: [{ provider: 'groq', key: 'mock-key' }]
                    }, '*');
                    break;

                case 'sendMessage':
                    window.postMessage({ type: 'messageLoading' }, '*');
                    setTimeout(() => {
                        window.postMessage({
                            type: 'messageResponse',
                            payload: {
                                content: "..This is a **mock response** from the browser environment! üåê\n\nI can simulate:\n- Markdown rendering\n- Code blocks\n- UI interactions",
                                model: message.payload.modelId,
                                tokens: 42,
                                usedProvider: message.payload.provider
                            }
                        }, '*');
                    }, 1500);
                    break;

                case 'getLogs':
                    window.postMessage({
                        type: 'logs',
                        payload: [
                            { id: '1', level: 'info', message: 'Webview mock initialized', timestamp: Date.now() },
                            { id: '2', level: 'debug', message: 'Testing log rendering', timestamp: Date.now() }
                        ]
                    }, '*');
                    break;
            }
        }
    </script>
</head>

<body>
    <div id="root"></div>
</body>

</html>